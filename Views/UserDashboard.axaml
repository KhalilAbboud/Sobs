<Window xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:Sobs.ViewModels"
             Icon="/Assets/avalonia-logo.ico"
             xmlns:views="clr-namespace:Sobs.Views"
             xmlns:models="clr-namespace:Sobs.Models"
             xmlns:conv="clr-namespace:Sobs.Converters"
             mc:Ignorable="d"
             x:Class="Sobs.Views.UserDashboard"
             x:DataType="viewModels:UserDashboardViewModel"
             Title="Your Tasks"
             Background="#112D4E" 
             d:DesignWidth="800"
             d:DesignHeight="450">

    <Window.Resources>
    <conv:BoolToYesNoConverter x:Key="BoolToYesNo"/>
    </Window.Resources>

  <Grid RowDefinitions="Auto,*,Auto" Margin="10" ColumnDefinitions="*">
    <!-- refresh and delete button -->
    <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" Margin="0,10,0,8">
      <Button Content="Refresh Elements"
              Command="{Binding ReloadCommand}"
              Width="150"/>
    </StackPanel>

    <StackPanel Grid.Row="1" Spacing="0">
    <!-- top of the table -->
    <Border Background="#2D3E50" Padding="8" CornerRadius="4" Margin="0,0,0,4">
        <StackPanel Orientation="Horizontal" Spacing="4">
        <TextBlock Text="ID"            Width="50"  FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Name"          Width="200" FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Responsible"   Width="150" FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Priority"      Width="80"  FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Start Date"    Width="100" FontWeight="Bold" Margin="2"/>
        <TextBlock Text="End Date"      Width="100" FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Documented"    Width="100" FontWeight="Bold" Margin="2"/>
        <TextBlock Text="Presented"    Width="100" FontWeight="Bold" Margin="2"/>
        </StackPanel>
    </Border>

    <!-- the dtabase stuff -->
    <ListBox Grid.Row="1"
             ItemsSource="{Binding Tasks}"
             SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
             Height="300"
             Margin="0,1,0,5"
             BorderBrush="#3A4A65"
             BorderThickness="1"
             Background="#1E272F"
             Foreground="White">

        <!-- Global ListBoxItem styling for the table elements -->
      <ListBox.Styles>
        <!-- the Base style -->
        <Style Selector="ListBoxItem">
          <Setter Property="Padding" Value="6,4"/>
          <Setter Property="Margin" Value="0,0,0,2"/>
          <Setter Property="Background" Value="Transparent"/>
        </Style>
        <!-- Alternating row shading of colors -->
        <Style Selector="ListBoxItem:nth-child(2n)">
          <Setter Property="Background" Value="#253043"/>
        </Style>
        <!-- Hovering effect -->
        <Style Selector="ListBoxItem:pointerover">
          <Setter Property="Background" Value="#32405B"/>
        </Style>
        <!-- Selected row effect (noraml selection) -->
        <Style Selector="ListBoxItem:selected">
          <Setter Property="Background" Value="#405673"/>
        </Style>
      </ListBox.Styles>

      <ListBox.ItemTemplate>
        <DataTemplate x:DataType="models:TaskModel">
          <StackPanel Orientation="Horizontal" Spacing="4">
            <TextBlock Text="{Binding TaskID}"          Width="50"  Margin="2"/>
            <TextBlock Text="{Binding Name}"            Width="200" Margin="2"/>
            <TextBlock Text="{Binding Responsible}"     Width="150" Margin="2"/>
            <TextBlock Text="{Binding Priority}"        Width="80"  Margin="2"/>
            <TextBlock Text="{Binding StartDate, 
                        StringFormat=dd-MM-yyyy}"       Width="100" Margin="2"/>
            <TextBlock Text="{Binding EndDate, 
                        StringFormat=dd-MM-yyyy}"       Width="100" Margin="2"/>
            <TextBlock Text="{Binding IsDocumented, Converter={StaticResource BoolToYesNo}}"    Width="100" Margin="2"/>
            <TextBlock Text="{Binding IsPresented,  Converter={StaticResource BoolToYesNo}}"    Width="100" Margin="2"/>
          </StackPanel>
        </DataTemplate>
      </ListBox.ItemTemplate>
    </ListBox>
    </StackPanel>

    <!-- a random count cuz why not lol -->
    <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" Margin="0,10,0,8">
      <Button Content="Refresh Elements"
              Command="{Binding ReloadCommand}"
              Width="150"/>
    </StackPanel>
    <TextBlock Grid.Row="2"
               Text="{Binding Tasks.Count, StringFormat=Total Tasks: {0}}"
               FontWeight="Bold"
               Margin="0,4,0,0"
               Foreground="White"/>
  </Grid>

</Window>
